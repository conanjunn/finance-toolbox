# 计量金融


# 统计基础

[我的分享PPT](/attached/stat.pdf)

统计就仨大问题：
- 抽样分布：

你去对一个集合抽样，出样出来的样本是符合一定分布的，抽样分布就是研究这些分布到底是啥、有啥特性。
你从总体中抽取样本构造一个叫集合叫“统计量”，然后通过这些样本去推断总体性质。
讲人话就是：要用抽样来估算总体。

- 参数估计：

上面说，你研究抽样分布，最终目的也是为了研究总体分布。那么就引出参数估计，估计啥？估计总体分布。
总体的分布如果知道，那就是估计他的参数了；总体的分布要是不知道，那你只能估点泛泛指标（均值、方差）了。

- 假设检验


## 基础概念

你抽样出来得到一个集合（$$X_1,X_2,...X_n$$），然后你尝试用这些样本去推断整体的统计特性（比如分布、均值、方差啥的。）

这个抽样集合（$$X_1,X_2,...X_n$$），它也是有个分布的呀，它也是一组随机变量的值啊，它也是被看做是一个随机变量（有自己的分布啥的）

然后你用这个集合（$$X_1,X_2,...X_n$$）构建出一些新的**“函数”**出来，得到的又是个新的随机变量，这玩意给了个新名字：**“统计量”**，是的，统计量就是个**“随机变量”**，所以丫也有概率分布呀。统计量在统计之地位，相当于，随机变量在概率中的地位。

啥意思？我举个例子吧，加入你从全国孩子里抽样孩子们的身高值，抽出1000个孩子，随机的，那，这每个孩子就对应上面说的$$X_1,X_2,...,X_{1000}$$，这是一次抽样，然后，你可以放回这些孩子，再抽一次，你又得到一组1000个孩子的抽样；然后，你干了一件事，对这两次的抽样，求了一个平均值，这个平均值$$\bar{X}=\sum_1^1000 X_i$$，就是一个所谓的统计量，对，他就是一个随机变量，它有了2个值（第一次抽样的均值、第二次抽样的均值），然后，这个随机变量，也就个统计量，他也会有有个概率分布，恩，我们就是要研究它的特性。

充分统计量：就是你这些抽样出来的统计量，完全可以代表样本总体，不损失什么信息。

常见的统计量：

- $$\bar{X}=\frac{1}{n}\sum_1^n X_i$$
- $$S^2=\frac{1}{n-1}\sum_1^n (X_i -\bar X)^2$$
....

我们后面不讨论一个抽样集合了，而都是讨论这些**统计量**。

### 均值统计量

如果是总体分布是正态的，那么样本均值这个统计量，它符合一个正态分布：

$$\bar{X} ~ N(\mu,\frac{\sigma^2}{n})$$

注意注意！这里的$$\sigma^2,\mu$$，都是总体样本的哈。

那你可能会问了，如果总体不是正态分布的咋办？幸运的是，通过中心极限定理的证明，得到结论，样本均值$$\bar{X}$$的分布还是，上面这个式子（均值为总体均值，方差为总体方差的的1/n），但是，前提是n得比较大才行，那多大算“比较大”？一般认为是抽样数超过30个。

**中心极限定理：**

均值为$$\mu$$，方差为$$\sigma^2$$的总体，抽样n个样本，n足够大的时候，样本均值$$\bar{X}$$的抽样分布，近似符合方差为$$\mu$$，方差为$$\sigma^2/n$$的正态分布。

注意！

这句话暗藏玄机，不是说你抽样的结果符合正态分布，而是你抽样的样本的均值，符合正太分布，讲人话，就是你抽n个，得到一个均值，然后你又去抽，又得到一个均值，前面说了，这个均值，就是统计量，就是个随机变量。现在说的是，这玩意，这个抽样的的均值，丫符合正态分布，懂了么？

另外，你观察这个正态分布的方差是$$\sigma^2/n$$，n是啥？n是抽样的个数，n越大，这个方差越小，也就是，你抽样出来的均值，他离总体样本均值的波动，越来越小。

### 方差统计量

样本方差$$S^2$$的统计量，比较复杂，书上说，它和总体分布有关。

如果总体分布是正态的，他的抽样样本的方差的分布为n-1的卡方分布。（啥是卡方分布，下面会讲）


## 几种分布

前面说过，抽样出来的集合（$$X_1,X_2,...X_n$$），也是有分布的，他们的分布，他们的**“函数”（统计量）**，也有一个分布了吧。

这里多说一句，你不是抽样么，你可以抽无数次啊（假如是放回抽样），我们说这个分布，指的是无数次的抽样的分布，这里的分布，就是你无数次抽样后，
这帮统计量的分布。

好，这帮货都会呈现啥分布呢？答案是常见的有“$$\mathcal{X}^2卡方分布,t分布，F分布$$”，参考：[1](https://www.cnblogs.com/think-and-do/p/6509239.html),[2](https://blog.csdn.net/anshuai_aw1/article/details/82735201)吧。

### 渐进分布

抽样集合符合一个分布，当抽样量大了以后，这个分布会趋向一个稳定分布，这个分布就叫这个统计量的渐进分布。

提这个概念干啥，是为了引出下面的这玩意：

如果$$X_1,X_2,...$$是总体样本N（0,$$\sigma^2$$）的样本集，可以证明，
- $$\sqrt{n}\bar{X}/\sigma$$ ~ N（0，1）

这个结论很有用，对后面假设检验，就构建这个统计量，用于假设检验。


### $$\mathcal{X}^2$$卡方分布

当 $$X_i$$ 服从标准正态分布（N（0,1））,由它构造出来的统计量，$$\sum_1^n X_i^2$$ 服从$$\mathcal{X}^2$$卡方分布。

![](/images/20210615/1623748500317.jpg)

n叫做自由度，自由度可以解释为自由的独立变量的个数，我也没深究。

对于卡方分布，**一堆正态分布的平方和** 就呈现了卡方分布。

### T分布

X ~ N（0，1）标准正态分布，Y ~ $$\mathcal{X}^2$$卡方分布，那，他们的合体，$$t=\frac{X}{\sqrt{Y/n}}$$ 服从自由度为n的T分布。

![](/images/20210615/1623749125965.jpg)

好了，你现在可以用这玩意了，

你抽出来的样本（$$X_1,X_2,...X_n$$），我们用他们构建一个新的统计量，

$$\bar{X}=\frac{1}{n}\sum_1^n X_i, S^2=\frac{1}{n-1}\sum_1^n (X_i - \bar{X})^2$$，

你看，前者是个正态分布，后者是个$$\mathcal{X}^2$$卡方分布，两者一凑（当然还得做一下归一化成标准正态分布啥的），就合体完正好服从T分布了。

嘿！你看，理论结合实践了，用起来了，居然把凑出的统计量，套到了一个T分布上了，哈哈。这T分布用处可以多了，后面会用的。


$$\frac{\sqrt{n}(\bar{X}-\mu)}{S} ~ t(n-1)$$

总结一下，**一个正态分布除以一个卡方分布，就变成了T分布**。

### F分布

再接再来，我们再“凑”一个新的分布出来！

先说说新引出的F分布，

Y 服从~ 自由度为m的$$\mathcal{X}^2$$卡方分布，Z 服从~ 自由度为n的$$\mathcal{X}^2$$卡方分布，俩合体一下，就变成了F分布。

$$X=\frac{Y/m}{Z/n}=\frac{nY}{mZ}$$

这合体，称作第一自由度为m，第二自由度为n的F分布：F（m,n）

![](/images/20210615/1623749731311.jpg)

总结一下，**一个卡方分布分布除以另外一卡方分布T分布，就变成了F分布**

## 参数估计

前面讨论了，用抽样样本，可以构建出“统计量”，用统计量，是不是可以反向估计出整个总体的特性呢？要是能，该多好啊！

我先斗胆、朴素、naive地估计一下：用样本均值，去估计总体的均值？用样本的方差去估计总体的方差？成不？

成！

### 点估计

这种方法，就叫做**“点估计”**。

虽然，理论上，你抽样的均值的期望等于总体的均值，讲人话，就是，你抽无数次，抽出个无数次的样本的均值，这些均值，最终的期望是真实总体的均值：

$$E(\bar{X})=\mu$$

但是，你不可能抽无数次，你的随机和偶然性，必然导致你用这些个抽样均值，去代表总体均值，是不准确的。

那么问题来了，“不准确的”，这种话就是屁话，有多不准确？你能给我一个量化的数么，概率也行啊。

答案是，不行！点估计给不出，所以，要引出区间估计。

### 区间估计

与点估计不同，点估计出一个值，区间估计给出一个**范围**。且，给出总体的值（比如总体的均值），落在这个区间的概率。

还记得，前面的**中心极限定理**不？

>均值为$$\mu$$，方差为$$\sigma^2$$的总体，抽样n个样本，n足够大的时候，样本均值$$\bar{X}$$的抽样分布，近似符合方差为$$\mu$$，方差为$$\sigma^2/n$$的正态分布。

我噻！看到正态分布了！为何我这么激动，有一个可以确定的分布了啊，我就能干好多事儿了啊。

来！我们来看看这个正态分布：我问你，这个正态分布的随机变量是是谁？是抽样的均值！别晕！
你抽一次（抽出100个样本），你算个均值出来，这个均值，就是一个随机变量的值；然后你再抽100个，又得到一个；你再抽、再抽、...
然后，你落在3个方差之外的概率是95%啊，我勒个去，给出了“落在这个区间的概率”了（就是前面提出的问题）。

这里千万别晕，你其实是不知道总体的$$\mu,\sigma$$的，对，你不知道；你知道只有一次次抽样的均值，我管它们叫:抽样均值1$$\bar{X}_1$$,抽样均值1$$\bar{X}_1$$,抽样均值1$$\bar{X}_1$$,...，它们是一组随机变量的值，对吧？

接下里的描述，太精妙了，我不自己组织语言了，我引用书上的话吧：

我们可以求出样本均值$$\bar{x}$$落在总体均值$$\mu$$的两侧的概率，但是，实际估计时候，我们只能知道$$\bar{x}$$，我们反倒是不知道$$\mu$$，它恰好是我们要求的东东。
**如果样本的均值$$\bar{x}$$落在总体均值$$\mu$$的两个总体标准差$$\sigma$$内，那么你也可以说成是，总体样本的均值$$\mu$$是落在样本均值$$\bar{x}$$的两个总体标准差$$\sigma$$之内**。
比如，用100次抽样出来的100个均值，有95个的样本均值+2个总体标准差$$\sigma$$范围内，包含了总体样本的均值$$\mu$$。

大白话说出这事，就是，哥们我抽样了1次，抽了N个（这个数不重要），得到一个均值$$\bar{X}$$，我现在就可以拍着胸脯说，兄弟，你这个均值$$\bar{X}$$，你左右探出去总体方差$$\sigma$$（但是，你不知道啊这个$$\sigma$$哈，强调一下），这个区间内，总体样本的均值$$\mu$$落在里面的概率是95%。

这里，我们一直都不知道总体样本的均值和方差$$\mu,\sigma$$啊，再次强调一遍，别晕，我们就是要求他们俩，但是，我们为了求他们俩，我们去抽了100次的样，得到了100个样本均值$$\bar{X}$$，我们只能用这些均值，来反向告诉别人，总体样本均值$$\mu$$，大概是落在这里面，多大概呢？那就得知道总体样本的方差$$\mu$$啊，可是这玩意，我不知道啊。不过，我看书上说，如果知道，就可以直接套用（我就奇了个怪了，您总体均值都待定呢，咋个就知道方差了呢）；如果不知道，就可以用抽样样本的方差来近似代替，别急，前提是样本数量n要足够多，一般要求n>30。



## 假设检验

步骤：

1、提出原假设和备择假设，原假设就是你想验证的结论，备择假设是它的方面。

2、指定检验中的显著性水平，就是他们一般说的$$\alpha$$，往往都很小，比如0.05，$$1-\alpha$$就是**置信度**。

3、收集样本数据并计算检验统计量的值，就是算一下样本们的方差啊、均值啊

4、利用检验统计量的值计算p-值

5、p-值法的拒绝法则，如果p-值<=显著性水平的值，则拒绝原假设H0

6、解读统计结论

**【p值是什么，$$\alpha$$是什么？】**

[参]: [1](https://zhuanlan.zhihu.com/p/26068572)

其实就是概率，你假设检验了$$H_0$$,那$$H_0$$发生的概率就是p，要是这数



### 正态检验

看一个序列是不是符合正态分布。话说，正态检验太重要了，如果一个时间序列不符合正态分布，那后面的检验都没有意义了。

常见的有SW检验（样本<50）和KS检验（样本>50），[示例代码](https://github.com/piginzoo/fund_analysis/blob/master/test/test_stat.py)。

#### SW:Shapiro-Wilk检验（小数据<50）


Shapiro-Wilk检验和Lilliefor检验都是进行大小排序后得到的，所以易受异常值的影响。

Shapiro-Wilk检验只适用于小样本场合（3≤n≤50）

$${\left(\sum_{i=1}^n a_i x_{(i)}\right)^2 \over \sum_{i=1}^n (x_i-\overline{x})^2}$$


[参]：[1](https://zhuanlan.zhihu.com/p/26539771),[2](https://www.jianshu.com/p/e202069489a6),[3](https://www.biaodianfu.com/python-normal-distribution-test.html),[4](https://zhuanlan.zhihu.com/p/26477641),[5](https://www.medsci.cn/article/show_article.do?id=0805180e5132)

#### KS:Kolmogorov-Smirnov检验（小数据>50）

柯尔莫戈洛夫-斯米诺夫检验（Kolmogorov-Smirnov test），简称K-S检验

K-S检验适合用于大数据样本的正态性检验，当样本的数据量超过50行时，它被认为是一个大样本，我们倾向于看K-S检验的分析结果得出结论。



### T检验

T检验，又叫做学生T检验，用于样本含量较小（如n<30），总体标准差$$\sigma$$未知的正态分布。

t检验是用t分布理论来推论差异发生的概率，从而**比较两个平均数的差异是否显著**。与f检验、卡方检验并列。

## 参考

- [《统计学》 贾俊平](https://book.douban.com/subject/10956491/)


